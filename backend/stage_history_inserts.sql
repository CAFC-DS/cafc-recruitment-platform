-- SQL to add stage history for players without position
-- Generated from player lists migration

-- Total players to fix: 911

-- AM list: 78 players

-- Marius Söderbäck (174947)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 174947
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kastriot Imeri (30111)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30111
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Milan Vukotic (68832)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68832
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Seth Ridgeon (175705)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 175705
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jayce Fitzgerald (119718)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119718
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jamie Mullins (88680)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 88680
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jun-ho Bae (139308)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 139308
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kieran Dowell (2625)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2625
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jack Moylan (83123)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 83123
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jamaldeen Jimoh-Aloba (115243)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115243
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115243
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Kamari Doyle (105409)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105409
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105409
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Cole Brannigan (174331)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 174331
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Conor Chaplin (25670)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25670
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Romeo Akachukwu (124928)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 124928
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Eliot Matazo (30542)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30542
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Eric Hamelberg (170839)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170839
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Romain Esse (152578)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 152578
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 152578
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Reggie Walsh (214083)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 214083
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tommy McDermott (117406)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117406
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leo Castledine (105731)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105731
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105731
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ra'ees Bangura-Williams (224865)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 224865
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Isaac Price (78963)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78963
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Omari Kellyman (107567)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107567
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107567
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Rubin Colwill (74040)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74040
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74040
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Bobby Clark (106048)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106048
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adam Phillips (38846)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38846
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alfie Devine (73591)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73591
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73591
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Rhys Youlley (213861)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 213861
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Shola Shoretire (47296)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 47296
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 47296
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Yuto Yamada (56861)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56861
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Amine Hemia (130644)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 130644
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Omri Gandelman (115103)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115103
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Taiyo Hiraoka (78942)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78942
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tawanda Chirewa (111389)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111389
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111389
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Rareș Ilie (106422)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106422
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106422
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Tibe De Vlieger (187857)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187857
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Svit Seslar (115621)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115621
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Toure (253655)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 253655
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josué Tiendrébéogo (220656)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 220656
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Myles Peart-Harris (53604)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53604
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leon Lalic (106466)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106466
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Levi Smans (117729)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117729
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117729
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Mohamed Ihattaren (31708)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31708
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Nassoh (75878)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75878
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Michal Sevcik (77495)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77495
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Olger Escobar (161889)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161889
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jonathan Asp Jensen (112074)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112074
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Wilmer Odefalk (127993)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 127993
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lilian Egloff (53560)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53560
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luka Tunjic (109809)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109809
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Youssef Maziz (15194)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 15194
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lukas Ambros (63336)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63336
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Will Alves (105084)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105084
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Killian Phillips (111559)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111559
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111559
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Laurin Ulrich (104856)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104856
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104856
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Maksim Stjopin (63272)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63272
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Julien Ponceau (45475)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45475
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marko Tolic (37543)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 37543
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Maurice Krattenmacher (104613)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104613
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Maxime Pau (131431)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 131431
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jeppe Kjær (57127)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 57127
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bambasé Conté (104323)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104323
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jardell Kanga (114832)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114832
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114832
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- George Earthy (109075)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109075
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109075
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Caylan Vickers (107637)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107637
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107637
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Bilal Bafdili (153633)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 153633
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dimitrios Kaloskamis (136047)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 136047
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 136047
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Anto Sekongo (219568)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219568
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Benjamin Brantlind (207223)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 207223
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David van der Werff (232265)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 232265
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daou Diomandé (253403)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 253403
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Isa Sakamoto (89702)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89702
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adriano Jagusic (167532)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 167532
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Abdoulaye Yoro (243584)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 243584
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Amin Boudri (122835)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122835
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Haine Eames (224009)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 224009
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 224009
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Hyun-ju Lee (112087)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112087
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adil Aouchiche (45844)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45844
  AND pl.LIST_NAME = 'AM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45844
  AND pl.LIST_NAME = 'AM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );


-- CF list: 180 players

-- Aliou Baldé (53098)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53098
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Omar Janneh (183840)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183840
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Viktor Djukanovic (115851)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115851
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yann Gboho (28170)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 28170
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mahamadou Sangaré (177269)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 177269
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yousef Salech (89548)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89548
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89548
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Zach Marsh (115215)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115215
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Thibault Klidjé (112223)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112223
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sinclair Armstrong (111777)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111777
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pierre Landry Kabore (285009)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 285009
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pierre Landry Kabore (285009)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 285009
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patrick Bamford (6734)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6734
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6734
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Nik Prelec (31290)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31290
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mamadou Doumbia (183626)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183626
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Donnell McNeilly (115203)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115203
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Divin Mubama (108290)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108290
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108290
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Davis Keillor-Dunn (21942)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21942
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dajaune Brown (108996)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108996
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Chido Obi (119723)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119723
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Benoný Breki Andrésson (127060)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 127060
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ben Casey (205225)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 205225
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Baylee Dipepa (182775)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182775
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Barney Stewart (238465)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 238465
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Antwoine Hackford (62913)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 62913
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adam Brett (185103)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 185103
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daniel Jebbison (79997)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79997
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79997
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Eliezer Mayenda (117225)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117225
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lamin Sillah (231692)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 231692
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kelvin Ehibhatiomhan (105256)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105256
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Justin Oboavwoduo (108785)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108785
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Justin Obikwu (169455)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169455
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jovan Milosevic (114859)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114859
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joe Brayson (145069)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 145069
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Evan Mooney (201845)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 201845
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fabian Schleusener (10067)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 10067
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jemiah Umolu (108999)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108999
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jimmy-Jay Morgan (108796)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108796
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joe Belmont (140554)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 140554
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ethan Wheatley (115206)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115206
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jayden Danns (108827)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108827
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108827
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Oumar Diakité (112481)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112481
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Iké Ugbo (6405)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6405
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6405
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- August Priske (118722)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118722
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bailey Brandtman (212080)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212080
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212080
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Benedikt Pichler (46600)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46600
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ante Matej Juric (115776)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115776
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bruny Nsimba (66525)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66525
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Armandas Kucys (113303)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113303
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Bamba (170774)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170774
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Bayo (44397)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 44397
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 44397
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Maurice Malone (27565)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27565
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Max Dean (105406)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105406
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Michael Frey (9079)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 9079
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 9079
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Michael Noonan (206809)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 206809
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 206809
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Miguel Di Pizio (212045)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212045
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212045
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Miguel Rodríguez (67223)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67223
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67223
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Mipo Odubeko (73648)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73648
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Matyas Vojta (137643)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 137643
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Albert Lottin (28658)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 28658
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alfred Scriven (66770)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66770
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Amin Chiakha (120605)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120605
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Andre Harriman-Annous (202205)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 202205
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 202205
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Andrej Kostic (185085)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 185085
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 185085
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Hyllarion Goore (245286)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 245286
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fer Niño (56401)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56401
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bryan Fiabema (67021)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67021
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fraser Hornby (38249)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38249
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gabin Capuano (235100)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 235100
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gaoussou Diakité (204342)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 204342
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 204342
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Harry Gray (183952)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183952
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ho-jae Lee (82104)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 82104
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ezekiel Alladoh (252178)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 252178
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 252178
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ibrahima Baldé (103406)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 103406
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ieltsin Camões (180313)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180313
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Filip Stojilkovic (12698)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 12698
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Brynjólfur Andersen Willumsson (13477)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 13477
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Callum Marshall (108876)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108876
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108876
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Cedric Itten (21226)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21226
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Chukwubuikem Ikwuemesi (117499)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117499
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117499
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Akito Suzuki (112538)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112538
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mason Melia (124923)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 124923
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Enzo Kana-Biyik (240010)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 240010
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 240010
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Erik Kojzek (217199)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 217199
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Esteban Crucci (206616)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 206616
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 206616
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Lassine Sinayoko (51669)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51669
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leander Alvheim (180682)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180682
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leon Grgic (106486)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106486
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leon Opitz (109588)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109588
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lion Lauberbach (23294)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23294
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lorenzo Colombo (42864)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 42864
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Louey Ben Farhat (118095)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118095
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luca Schuler (68956)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68956
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luis Vázquez (70046)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 70046
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ismael Konate (201360)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 201360
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jacob Ambæk (214252)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 214252
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 214252
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jakub Pira (183405)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183405
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183405
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jalal Abdullai (166323)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 166323
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 166323
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- James Wilson (137222)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 137222
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 137222
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Janis Antiste (56629)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56629
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56629
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jerry Afriyie (244139)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 244139
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 244139
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Kelvin Yeboah (46598)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46598
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kenny Quetant (311686)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 311686
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 311686
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Kieran Wilson (232119)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 232119
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kieron Bowie (99598)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99598
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99598
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ota Yamamoto (147195)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 147195
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 147195
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Luka Jovanovic (212055)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212055
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nikolas Muci (81118)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81118
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Noah Ohio (73957)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73957
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73957
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Noel Futkeu (70555)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 70555
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Oliver Ross (106607)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106607
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Omar Faraj (108718)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108718
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108718
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Omar Sadik (183028)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183028
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nesta Elphege (91932)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 91932
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 91932
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Luka Kulenovic (166654)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 166654
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luke Plange (105318)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105318
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lyndon Dykes (67242)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67242
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 4
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 4' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67242
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 4'
  );

-- Marco Hoffmann (219818)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219818
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mark O'Mahony (112636)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112636
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112636
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Mason Burstow (107586)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107586
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jessic Ngankam (27388)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27388
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jesús Ramírez (117405)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117405
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joe Gelhardt (49617)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49617
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49617
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- John Paul Dembe (171413)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 171413
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jordi Paulina (122375)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122375
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jorge Pascual (105888)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105888
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Berte (81140)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81140
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Guindo (175793)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 175793
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Touré (161992)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161992
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161992
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Motoki Nagakura (170633)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170633
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Myziane Maolida (5767)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 5767
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nacho Ferri (104384)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104384
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104384
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Nathan Butler-Oyedeji (105343)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105343
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Phil Harres (63660)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63660
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sota Nakamura (246896)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 246896
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ousmane Camara (66826)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66826
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Owen Elding (161272)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161272
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161272
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Owen Graham-Roache (244687)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 244687
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pape Moussa Fall (175976)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 175976
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patrik Mijic (116092)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116092
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Theo Bair (48711)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 48711
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 48711
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Philippe Keny (51681)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51681
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51681
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ronan Hale (86601)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 86601
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 86601
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Prosper Peter (254376)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 254376
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Quentin Paris (221501)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 221501
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Raimonds Krollis (63299)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63299
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rayan Kolli (170742)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170742
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Richonell Margaret (28777)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 28777
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ross Stewart (79537)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79537
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79537
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Sambou Soumano (74498)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74498
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74498
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Seb Palmer-Houlden (168946)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 168946
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 168946
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Seedy Jatta (80015)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 80015
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Shio Fukuda (158837)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158837
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158837
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Shumaira Mheuka (115190)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115190
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sidiki Chérif (169121)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169121
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rio Nitta (81697)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81697
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Stefán Ingi Sigurdarson (13282)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 13282
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Steve Ngoura (117427)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117427
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Taichi Hara (50085)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 50085
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 50085
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Taisei Miyashiro (27605)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27605
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27605
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tamble (154094)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 154094
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 154094
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Tawfik Bentayeb (221500)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 221500
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Will Lankshear (120698)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120698
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120698
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tobias Lauritsen (43892)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43892
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43892
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tomas Cvancara (32176)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32176
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32176
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Uros Sremcevic (126476)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126476
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126476
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Vladislavs Gutkovskis (49510)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49510
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49510
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Zini (53290)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53290
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ștefan Baiaram (88113)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 88113
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Robbie Ure (107254)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107254
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Thom van Bergen (153643)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 153643
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dane Scarlett (52845)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52845
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52845
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Daniel Fila (77460)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77460
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77460
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Elmin Rastoder (70433)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 70433
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daniel Karlsbakk (63412)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63412
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63412
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Danny Namaso (27722)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27722
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27722
  AND pl.LIST_NAME = 'CF'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Dare Kareem (249592)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 249592
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David Min (67289)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67289
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David Toshevski (67960)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67960
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Duarte Moreira (46928)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46928
  AND pl.LIST_NAME = 'CF'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );


-- DM/CM list: 262 players

-- Moussa Baradji (215936)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 215936
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ethan Erhahon (31705)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31705
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ondrej Kricfalusi (120168)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120168
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- James McConnell (109103)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109103
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jardell Kanga (114832)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114832
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josh Mulligan (85100)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 85100
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Krystof Danek (53990)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53990
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Laurin Ulrich (104856)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104856
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lilian Egloff (53560)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53560
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Derek Mazou-Sacko (103529)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 103529
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luka Tunjic (109809)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109809
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lukas Ambros (63336)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63336
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Abdul Moro (219766)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219766
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tommy Doyle (27169)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27169
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Stefán Teitur Thórdarson (78784)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78784
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tommy Pilling (107758)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107758
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Trey Nyoni (153585)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 153585
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tyler Fletcher (137217)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 137217
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Vanja Dragojevic (179872)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 179872
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patrick Kelly (118609)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118609
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tom Iorpenda (182473)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182473
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tom Cairney (24052)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 24052
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tobias Brenan (277772)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 277772
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ollie Harrison (126217)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126217
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sean Neave (126216)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126216
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Scott Bailey (114365)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114365
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sammy Braybrooke (105227)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105227
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ryan Doherty (229380)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 229380
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Vimal Yoganathan (170001)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170001
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Owen Eames (151872)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 151872
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ousmane Diakité (46671)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46671
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zane Albarus (108748)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108748
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zack Nelson (119982)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119982
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zaïd Bafdili (141292)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 141292
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nelson Ishiwatari (120034)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120034
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mussa Kaba (174358)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 174358
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Moses Sesay (153582)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 153582
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mohamed Koné (279919)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 279919
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ognjen Ugresic (179876)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 179876
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jesse Middleton (220971)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 220971
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jaïro Riedewald (9010)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 9010
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jaden Heskey (108789)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108789
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jack Moorhouse (109116)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109116
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jack Fletcher (118979)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118979
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ife Ibrahim (202204)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 202204
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harrison Armstrong (159723)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159723
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- George Abbott (108882)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108882
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Finlay Cartwright (158287)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158287
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ethan Galbraith (3585)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 3585
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josh King (120012)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120012
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daniel Phillips (67235)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67235
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Courtney Clarke (105153)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105153
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Connor Barron (115565)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115565
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Charlie Savage (105087)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105087
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Casper De Norre (29819)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 29819
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Cameron Brannagan (24779)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 24779
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Brandon Khela (108286)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108286
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Blaine McClure (182283)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182283
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ben Whiteman (24075)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 24075
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Anthony Munda (118778)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118778
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alfie Devine (73591)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73591
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Aidan Borland (174340)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 174340
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ethan Brierley (59439)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59439
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Aaron Ciammaglichella (114690)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114690
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joel Colwill (122575)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122575
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luke Cundle (53617)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53617
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luca Connell (42898)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 42898
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Louie Copley (159775)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159775
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lewis Orford (108787)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108787
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Law McCabe (115172)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115172
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kamil Conteh (108299)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108299
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luke Rawlings (160257)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160257
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lewis Miley (109109)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109109
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109109
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Callum Olusesi (118624)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118624
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Romeo Arrhenius Leandersson (230754)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 230754
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Márk Kosznovszky (31711)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31711
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Njegos Petrovic (30618)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30618
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Noah Streit (162316)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 162316
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Wilfred George Igor (180822)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180822
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Max Bird (38898)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38898
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38898
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Maximilian Dietz (53327)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53327
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Melayro Bogarde (49406)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49406
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49406
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Melle Meulensteen (51441)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51441
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Metinho (89637)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89637
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89637
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Markus Karlsson (107207)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107207
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Max Balard (211969)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 211969
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Brian De Keersmaecker (75673)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75673
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75673
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Brandon Aguilera (125185)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125185
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Atsuki Ito (77562)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77562
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77562
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Beñat Gerenabarrena (226757)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 226757
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Abdoulaye Touré (1912)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 1912
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Abubakr Barry (217260)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 217260
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 217260
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Arthur Avom (187365)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187365
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alonzo Engwanda (75564)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75564
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Andrés Perea (27432)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27432
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ante Palaversa (4754)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4754
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Anto Sekongo (219568)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219568
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Antoni Kozubal (74056)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74056
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Hyeok-kyu Kwon (169500)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169500
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169500
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Arthur Piedfort (114860)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114860
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114860
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Axel Kryger (180619)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180619
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ayoni Santos (187641)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187641
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ayumu Seko (32344)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32344
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32344
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Barry Baggley (79615)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79615
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dariusz Stalmach (94989)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 94989
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 94989
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Casper Winther (67709)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67709
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67709
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Charalampos Charalampous (83616)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 83616
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Charlie Webster (105342)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105342
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105342
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Cheveyo Tsawa (122113)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122113
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Connor Metcalfe (110604)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 110604
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Corey Hollman (112492)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112492
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daiki Matsuoka (55916)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 55916
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 55916
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Dan Neil (69379)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69379
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69379
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Dani Requena (122592)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122592
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daniel Edelman (112304)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112304
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Domingos Andrade (52955)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52955
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52955
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- David Ayala (53020)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53020
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53020
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- David Edvardsson (32280)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32280
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David González (53580)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53580
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David Planka (160031)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160031
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David Santos (159985)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159985
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159985
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- David Watson (119776)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119776
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Daylam Meddah (69035)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69035
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yotaro Nakajima (159614)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159614
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dzenis Burnic (940)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 940
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Edan Diop (138809)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 138809
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Edouard Michut (75547)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75547
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75547
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Elliot Watt (38940)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38940
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Emil Kornvig (2197)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2197
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Enzo Bardeli (52467)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52467
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Enzo Montet (247370)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 247370
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gabriel Sigua (133151)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 133151
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ethan Alagich (212049)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212049
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212049
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Franz-Ethan Meichtry (215984)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 215984
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Freddie Potts (105248)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105248
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jens Hjertø-Dahl (138739)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 138739
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ibrahim Fofana (116502)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116502
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gibson Yah (75828)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75828
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75828
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Giovanni Haag (47214)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 47214
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gjivai Zechiël (173114)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 173114
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 173114
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Glen Kamara (26342)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 26342
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 26342
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Hakim Sahabo (170785)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170785
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170785
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Harvey White (45865)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45865
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45865
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Hinata Kida (27372)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27372
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Espen van Ee (170801)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170801
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ibrahima Sissoko (3293)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 3293
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Imourane Hassane (239988)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 239988
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Isaac Pappoe (178125)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178125
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Issiaga Camara (187366)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187366
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Iván Morante (42879)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 42879
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- James McManus (112626)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112626
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112626
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jamie Roche (66441)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66441
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jan Zíka (214809)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 214809
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jannes Van Hecke (51619)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51619
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joe Knight (115188)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115188
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ludwig Malachowski Thorell (114848)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114848
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luka Hyryläinen (104346)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104346
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104346
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Luka Vrbancic (119125)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119125
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Liam Chipperfield (111544)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111544
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111544
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jocelyn Janneh (115006)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115006
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jochem Ritmeester van de Kamp (117725)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117725
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luca Belardinelli (71238)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 71238
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jonathan Bland (170002)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170002
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170002
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jonathan Shore (151705)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 151705
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jordan Mendes (236817)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 236817
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lamare Bogarde (73578)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73578
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joshua Kitolano (30113)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30113
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jovan Lukic (86504)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 86504
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Junior Mwanga (114470)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114470
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leo Mätzler (51633)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51633
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tobias Koch (31787)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31787
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tobias Lauritsen (43892)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43892
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tika de Jonge (80092)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 80092
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lauge Sandgrav (70596)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 70596
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Laurits Pedersen (126688)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126688
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jurica Prsir (66346)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66346
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leon Robinson (217242)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 217242
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nolan Binet (279532)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 279532
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lohann Doucet (108710)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108710
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Louis Mouton (109873)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109873
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109873
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Niv Yehoshua (114776)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114776
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Noah Mbamba (63324)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63324
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63324
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Nobuteru Nakagawa (254478)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 254478
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 254478
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Nodar Lominadze (150429)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 150429
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luke McCowan (120974)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120974
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nikolas Sattlberger (78695)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78695
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78695
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Léandre Kuavita (106553)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106553
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mads Bomholt (180219)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180219
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marc Leonard (105244)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105244
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105244
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Marcus Melchior (180743)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180743
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marius Courcoul (169125)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169125
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169125
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Miguel Reichmuth (114937)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114937
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Martin Adeline (108258)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108258
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108258
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Matias Siltanen (181698)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 181698
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 181698
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Justin Lonwijk (5706)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 5706
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kacper Duda (65787)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 65787
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kaito Yasui (112196)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112196
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mirza Catovic (161749)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161749
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161749
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Mohamadou Kanté (174197)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 174197
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 174197
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Mohammed Abu Fani (13210)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 13210
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Titouan Thomas (45964)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45964
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Máté Tuboly (122544)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122544
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nectarios Triantis (169586)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169586
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169586
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Lukas Björklund (106052)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106052
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Niklas Swider (132329)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 132329
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 132329
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Niko Sigur (161792)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161792
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Oussama El Azzouzi (117311)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117311
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117311
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Satoshi Tanaka (53362)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53362
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53362
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Sean Fusire (131788)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 131788
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 131788
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Ryan Fosso (105840)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105840
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105840
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Oscar Fraulo (63262)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63262
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 63262
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Otto Tiitinen (213789)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 213789
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 213789
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Santeri Väänänen (46240)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46240
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pape Diong (184579)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184579
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rassoul Ndiaye (52913)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52913
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52913
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Paul Okon-Engstler (178545)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178545
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pedro Alemañ (52483)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52483
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pedro Bravo (82636)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 82636
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 82636
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Pierre Dwomoh (52537)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52537
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52537
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Preston Fearon (160510)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160510
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160510
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Rudy Matondo (214501)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 214501
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alex Robertson (111445)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111445
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111445
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Alexander De Ridder (250062)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 250062
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 250062
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Rayan Touzghar (219564)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219564
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219564
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Renato Nhaga (253293)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 253293
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 253293
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Rhys Bozinovski (212069)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212069
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rihito Yamamoto (99534)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99534
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99534
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Romeo Amane (113700)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113700
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113700
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Rabby Nzingoula (200061)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 200061
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 200061
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jenson Metcalfe (109026)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109026
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109026
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ryan Teague (53055)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53055
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ryan Trevitt (119910)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119910
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Samba Diba (116511)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116511
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Samuel Justo (106381)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106381
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Stije Resink (75685)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75685
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75685
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Wout Asselman (280649)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 280649
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 280649
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Xavier Adang (167793)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 167793
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yassine Kechta (80087)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 80087
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Valdemar Møller (188148)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 188148
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 188148
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Sem Scheperman (112417)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112417
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112417
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Sondre Granaas (180121)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180121
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180121
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Sotiris Kontouris (184956)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184956
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184956
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Sverre Sandal (180660)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180660
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Taichi Fukui (81710)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81710
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Thomas Jørgensen (119101)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119101
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119101
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tim Breithaupt (68268)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68268
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tim Meyer (167521)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 167521
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Timothy Ouma (119246)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119246
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Timothé Cognat (6287)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6287
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6287
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Rajmund Tóth (212878)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212878
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ralph Priso (53032)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53032
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patrick Yazbek (112497)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112497
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tom van de Looi (32049)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32049
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32049
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tyrone Owusu (96338)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 96338
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ugo Raghouber (105856)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105856
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105856
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Valentino Müller (30460)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30460
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Valmir Matoshi (123089)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 123089
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zane Schreiber (178065)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178065
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yuki Yamamoto (66184)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66184
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zento Uno (181071)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 181071
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 181071
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Zidane Iqbal (105224)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105224
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105224
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Étienne Camara (73601)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73601
  AND pl.LIST_NAME = 'DM/CM'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73601
  AND pl.LIST_NAME = 'DM/CM'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );


-- GK list: 74 players

-- Tommy Setford (105635)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105635
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nils Ramming (169161)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 169161
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Murphy Cooper (112069)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112069
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josh Keeley (86381)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 86381
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- James Beadle (111114)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111114
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Elyh Harrison (117643)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117643
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Corey Addai (24284)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 24284
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alex Bass (25397)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25397
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Liam McFarlane (119757)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119757
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119757
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jonathan Fischer (180229)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180229
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- George Wickens (38978)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38978
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 38978
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ewen Jaouen (141179)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 141179
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Filip Marschall (105165)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105165
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gus Hoefsloot (212071)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212071
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Hans Christian Bernat (4579)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4579
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harry Tyrer (77531)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77531
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77531
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Iker Álvarez (78648)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78648
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Teddy Sharman-Lowe (59438)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59438
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59438
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jacopo Seghetti (123507)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 123507
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jamie Cumming (27066)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27066
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jan Koutny (216755)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 216755
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Niklas Hedl (31255)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31255
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alex Paulsen (53276)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53276
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ander Astralaga (106007)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106007
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ben Voll (65783)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 65783
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 65783
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Diogo Pinto (105917)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105917
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105917
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Aarón Escandell (7314)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 7314
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Myles Roberts (161297)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161297
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161297
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Nathan Trott (21075)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21075
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21075
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Nikola Cavlina (66684)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66684
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Noah James (212036)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212036
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212036
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Owen Goodman (105098)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105098
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patrick Beach (178067)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178067
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patrick Schulte (125542)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125542
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125542
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Josh Griffiths (69197)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69197
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69197
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Paul Argney (126501)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126501
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pavlo Isenko (116723)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116723
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116723
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Joe Gauci (187782)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187782
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jonas Kersken (104448)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104448
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jonas Krumrey (78816)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78816
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78816
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Ivan Pakholiuk (3401)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, CAFC_PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.CAFC_PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.CAFC_PLAYER_ID = 3401
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Elis Bishesari (114827)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114827
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alby Kelly-Heald (162350)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 162350
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 162350
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Alessandro Calligaris (106154)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106154
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106154
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Viktor Johansson (21070)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21070
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tiernan Brooks (148306)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 148306
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 4
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 4' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 148306
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 4'
  );

-- Tjark Ernst (112089)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112089
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tobe Leysen (52529)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52529
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52529
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tom Ritzy Hülsmann (104207)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104207
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104207
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tommaso Martinelli (120662)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120662
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120662
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Pierce Charles (129327)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 129327
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 129327
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Tommy Simkin (107677)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107677
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107677
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Vic Chambaere (53675)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53675
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lukas Kelly-Heald (162351)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 162351
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mathieu Patouillet (57884)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 57884
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 57884
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Mathys Niflore (160297)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160297
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Matthias Pieklak (141296)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 141296
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Matthieu Epolo (81096)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81096
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Max Vartuli (180218)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180218
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lucas Lund (82844)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 82844
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kacper Tobiasz (68172)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68172
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Quentin Braat (1674)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 1674
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rafal Leszczynski (37748)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 37748
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Samuel Soares (49879)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49879
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49879
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Silas Huber (108442)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108442
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tae-hui Han (180581)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180581
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Patryk Letkiewicz (240694)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 240694
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Julian Krahl (26934)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 26934
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kacper Trelowski (56319)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56319
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Karlo Letica (3472)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 3472
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kayne van Oevelen (117621)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117621
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117621
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Kees Sims (162345)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 162345
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lazar Carević (29405)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 29405
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 29405
  AND pl.LIST_NAME = 'GK'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Lubomir Belko (88437)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 88437
  AND pl.LIST_NAME = 'GK'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );


-- LB/LWB list: 150 players

-- Jasper Dahlhaus (67258)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 67258
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Henry Oware (197842)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 197842
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Elliot Stroud (159573)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159573
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Domagoj Bukvic (127822)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 127822
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Srdjan Kuzmic (116739)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116739
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116739
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Lukas Engel (74073)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74073
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mauro Perkovic (66650)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66650
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Owen Beck (57118)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 57118
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Robert-Jan Vanwesemael (186238)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 186238
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tiago Araújo (31315)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31315
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jayden Meghoma (108808)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108808
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dennis Cirkin (49054)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49054
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jayden Lienou (215005)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 215005
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jacob Slater (117825)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117825
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harry Milne (188426)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 188426
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harley Mills (176236)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 176236
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Genesis Antwi (126427)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126427
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Christian McFarlane (106178)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106178
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Callum Elder (23773)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23773
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Andre Garcia (187668)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187668
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Somto Boniface (108953)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108953
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yisa Alao (245623)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 245623
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Taylan Harris (115222)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115222
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sean Roughan (69202)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69202
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sean Keogh (207249)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 207249
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sam McCallum (59206)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59206
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Owen Dodgson (104443)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104443
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Niko Takahashi (106871)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106871
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lucas Pires (113756)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113756
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Liberto Navascués (224788)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 224788
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jordan Amavi (23684)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23684
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23684
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Kai Wagner (23498)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23498
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Evan Weir (120813)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120813
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Evans Jean-Lambert (71082)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 71082
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fabian Greilinger (51527)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51527
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fabian Nürnberger (51600)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51600
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Eirik Saunes (180625)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180625
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Eric-Junior Bocat (58181)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 58181
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 58181
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Derry Murkin (75583)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75583
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75583
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jakub Krzyzanowski (125024)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125024
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125024
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- James Morris (106274)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106274
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106274
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jayden Fevrier (105454)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105454
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105454
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Daniel Stefulj (52288)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52288
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Darlin Yongwa (53153)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53153
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David Herold (52666)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52666
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52666
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Dion Gallapeni (228533)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 228533
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dylan Ourega (228689)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 228689
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 228689
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Dylan Williams (73615)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73615
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73615
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Fabio Ferraro (99317)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99317
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99317
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Emeka Adiele (159603)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 159603
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Emmanuel Longelo (39014)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 39014
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 39014
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Enda Stevens (25821)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25821
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25821
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jake Bidwell (23795)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23795
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23795
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Baran Moğultay (118267)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118267
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Antonino Gallo (51865)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51865
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Aron Dønnum (43915)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43915
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43915
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Arthur Zagré (27263)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27263
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Aske Adelgaard (117420)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117420
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Barna Benczenleitner (135540)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 135540
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bas Kuipers (21559)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21559
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21559
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Ben Chrisene (59225)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59225
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59225
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Benedikt Bauer (82645)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 82645
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Benjamin Böckle (31800)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31800
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bruno Onyemaechi (118811)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118811
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Caleb Wiley (112345)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112345
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112345
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- George Bello (48552)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 48552
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 4
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 4' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 48552
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 4'
  );

-- Alex Murphy (112651)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112651
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112651
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Alpha Touré (184585)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184585
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Felipe Andrade (165245)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 165245
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Finley Munroe (107645)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107645
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fotis Kitsos (68994)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68994
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68994
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Geoffrey Kondo (131686)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 131686
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adriano (160355)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160355
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gideon Mensah (13344)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 13344
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harrison Burrows (59303)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59303
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Christopher Cheng (66865)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66865
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66865
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Harry Pickering (25176)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25176
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ismaël Boura (66801)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66801
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66801
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jack Currie (75517)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75517
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75517
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Cheick Souaré (73636)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 73636
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ben Brannan (182005)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182005
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182005
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Anthony Markanich Jr. (112555)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112555
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 112555
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Abdoul Rachid Ayindé (179907)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 179907
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adam Aznou (119227)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119227
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 119227
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Adem Avdic (139007)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 139007
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Adrian Pereira (43987)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43987
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Keita Kosugi (184561)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184561
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Linton Maina (31977)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31977
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Leo Fuhr Hjelde (79547)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79547
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79547
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Kristian Bari (97045)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 97045
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kenneth Schmidt (94847)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 94847
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Logan Ndenbe (31112)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31112
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Luke Chambers (105177)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105177
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 4
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 4' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105177
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 4'
  );

-- Junior Ligue (137754)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 137754
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 137754
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Josh Wilson-Esbrand (105115)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105115
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105115
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Joseph Kalulu (200812)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 200812
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Takahiro Akimoto (77564)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 77564
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Travis Patterson (105169)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105169
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tomas Galvez (106100)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106100
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Thomas Van den Keybus (52653)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52653
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tayo Adaramola (105399)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105399
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105399
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jorge Salinas (220297)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 220297
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 220297
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Sékou Fofana (219046)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219046
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Stefan Bukinac (114861)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114861
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Stavros Pilios (132150)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 132150
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Vasilios Zagaritis (74041)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 74041
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Oliver Zandén (48896)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 48896
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 48896
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Lucas Anjos (161860)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161860
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Michal Gurgul (125018)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125018
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Max Conway (107660)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107660
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107660
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Marcus Rafferty (107428)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107428
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marko Divkovic (54746)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 54746
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Michal Karbownik (28596)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 28596
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Matej Polidar (53818)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53818
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Matias Rale (88702)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 88702
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Matteo Cocchi (120639)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120639
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120639
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jonas Rouhi (105772)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105772
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105772
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Jonas Lange Hjorth (180670)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180670
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joel Bagan (59450)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59450
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59450
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Joe Johnson (161460)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161460
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161460
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Kaiki (158599)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158599
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158599
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Tuomas Ollila (46228)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46228
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nazinho (106378)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106378
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Moncef Zekri (255370)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 255370
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 255370
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Mohamed Ouédraogo (200097)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 200097
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 200097
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Min-seo Park (244592)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 244592
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mikkel Rakneberg (113547)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113547
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113547
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Mika Haas (104827)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104827
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104827
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Souleyman Doumbia (41400)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 41400
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Souffian El Karouani (75762)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 75762
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Simun Hrgovic (107110)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107110
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harry Amass (161462)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161462
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 4
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 4' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 161462
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 4'
  );

-- Shinya Nakano (53356)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53356
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sherel Floranus (2322)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2322
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Noah Dodeigne (168744)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 168744
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zakaria Ariss (220032)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 220032
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ylies Aradj (136193)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 136193
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yasser Larouci (41428)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 41428
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 41428
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Yannick Leliendal (30998)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30998
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30998
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Will Ferry (25289)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25289
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 25289
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tuur Rommens (53163)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53163
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53163
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Philippe Ndinga (273770)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 273770
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sam De Grand (107042)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107042
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Saba Kharebashvili (3402)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, CAFC_PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.CAFC_PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.CAFC_PLAYER_ID = 3402
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, CAFC_PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.CAFC_PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.CAFC_PLAYER_ID = 3402
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Roy Revivo (115334)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115334
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pedro Bondo (113057)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113057
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 113057
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Olivier Deman (47122)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 47122
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 47122
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Oliver Scarles (108782)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108782
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108782
  AND pl.LIST_NAME = 'LB/LWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Nolan Gillot (219850)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219850
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Noah Tolf (208099)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 208099
  AND pl.LIST_NAME = 'LB/LWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );


-- RB/RWB list: 167 players

-- Yu Hirakawa (180981)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180981
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180981
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Woyo Coulibaly (51683)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51683
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sidny Cabral (148931)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 148931
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rajmund Tóth (212878)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212878
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212878
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Precious Ugwu (160449)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160449
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alex Timossi Andersson (32413)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 32413
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Oscar Naasei (207595)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 207595
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Benjamin Fredrick (162418)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 162418
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- George Finney (160503)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160503
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jeremy Ngakia (55840)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 55840
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jesús Fortea (179561)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 179561
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josh Neufville (59030)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59030
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tristan Crama (125025)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 125025
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Terry Devlin (115923)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115923
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115923
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Soichiro Mori (252120)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 252120
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Junior Tchamadeu (106225)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106225
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rory Whittaker (178360)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178360
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nathan Patterson (30272)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 30272
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marco Palestra (133594)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 133594
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lakyle Samuel (109145)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109145
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kellen Fisher (168194)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 168194
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Brooklyn Nfonkeu (118978)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118978
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ethan Ennis (105691)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105691
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Denzel Hall (26615)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 26615
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bosun Lawal (99743)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 99743
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ashqar Ahmed (179297)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 179297
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Amadou Mbengue (105070)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105070
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Femi Seriki (81082)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81082
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81082
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Ronan Kpakio (140562)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 140562
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 140562
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Alfie Gilchrist (106886)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106886
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106886
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Jayden Fevrier (105454)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105454
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Danny Imray (105439)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Video Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 105439
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fin Stevens (68284)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68284
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68284
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Conrad Wallem (81085)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81085
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81085
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Damjan Kovacevic (182867)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182867
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- David Jaunegg (117475)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 117475
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dawid Bugaj (122605)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122605
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dembo Sylla (118650)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118650
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Arlind Kurti (135893)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 135893
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Arnau Puigmal (26673)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 26673
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 26673
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Connor Barrett (111607)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111607
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Carlens Arcus (4120)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4120
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4120
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Carlos Isaac (5875)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 5875
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Chang-woo Lee (184619)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184619
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Colby Donovan (185457)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 185457
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Carlos Mora (150134)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 150134
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Christ-Owen Kouassi (219573)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 219573
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Cherrion Valerius (187707)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187707
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187707
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Charlie Tasker (109191)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 109191
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Denzel De Roeve (106070)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106070
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Bryan Reynolds (27676)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27676
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27676
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Bali Mumba (59008)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59008
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 59008
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Bendegúz Farkas (122581)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 122581
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Amine Chabane (209739)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 209739
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Boris Matic (136726)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 136726
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alfons Sampsted (12961)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 12961
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 12961
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Alexis Alégué (1545)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 1545
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Alec Georgen (5801)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 5801
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Amar Memic (115921)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115921
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ahmed Diomandé (215273)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 215273
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Anthony Ralston (6360)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6360
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6360
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Aurélien Platret (130793)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 130793
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Benjamin Boakye (104928)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 104928
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Brandon Soppy (49715)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49715
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 49715
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jean Manuel Mbom (3719)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 3719
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Harrison Ashby (69541)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69541
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69541
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Hayate Matsuda (147366)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 147366
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Henry Heroki Mochizuki (202333)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 202333
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Hidde ter Avest (19610)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 19610
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Hjalte Bidstrup (126664)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126664
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pedro Lima (184526)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184526
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 184526
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Jahkeele Marshall-Rutty (66317)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66317
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66317
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- James Dornelly (176237)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 176237
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 176237
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Hampus Skoglund (207061)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 207061
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jhon Banguera (111079)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 111079
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jonas Mortensen (27179)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 27179
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josh Honohan (87321)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 87321
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Josh Key (69188)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 69188
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Joshua Rawlins (53039)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53039
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Jaden Mears (133105)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 133105
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Dominik Piła (115803)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115803
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Edney (179944)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 179944
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yuri Guboglo (248377)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 248377
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Yvann Titi (126508)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126508
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Zach de Jesus (212002)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212002
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Enzo Tacafred (273488)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 273488
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Guilherme Siqueira (187234)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 187234
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Guille Rosas (66284)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66284
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nathan Harriel (79232)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79232
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marek Havran (213307)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 213307
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Mark Sykes (29397)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 29397
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 29397
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Marlon Fossey (16050)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 16050
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 16050
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Mateo Lisica (66208)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66208
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66208
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Maximilian Fillafer (121125)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 121125
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Michael Ameyaw (95001)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 95001
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Juan Mosquera (56733)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56733
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 56733
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Moutaz Neffati (120241)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120241
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Marco Rente (23500)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 23500
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Niklas Vesterlund (3789)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 3789
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Nolan Galves (130750)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 130750
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 130750
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Norbert Wojtuszek (68222)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 68222
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Oliver Braude (160126)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160126
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160126
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Oliver Olsen (4581)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4581
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Oliver Sonne (89569)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89569
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 89569
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Moses Odubajo (6841)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6841
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6841
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Julian Eitschberger (108129)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108129
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Furkan Demir (116076)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116076
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Eric da Silva Moreira (106433)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106433
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106433
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Faissal Al Mazyani (114873)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 114873
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Felix Passlack (1077)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 1077
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Filip Kruselj (160828)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160828
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Giorgi Maisuradze (167633)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 167633
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Fredrik Carson Pedersen (66864)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66864
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gaizka Larrazabal (52169)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 52169
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Gela Sadghobelashvili (3501)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, CAFC_PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.CAFC_PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.CAFC_PLAYER_ID = 3501
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Genesis Antwi (126427)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 126427
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Giorgi Gvasalia (3801)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, CAFC_PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.CAFC_PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.CAFC_PLAYER_ID = 3801
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, CAFC_PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.CAFC_PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.CAFC_PLAYER_ID = 3801
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Filip Lissah (170061)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170061
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 170061
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Triantafyllos Tsapras (143807)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 143807
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 143807
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Silvan Hefti (29871)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 29871
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Srdjan Kuzmic (116739)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116739
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 116739
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Diogo Spencer (106792)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 106792
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Thomas Aquilina (212038)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 212038
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Timothée Pembélé (45841)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45841
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 45841
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Tom Pouilly (183671)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 183671
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tomas Totland (43957)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 43957
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Siebe Horemans (2794)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2794
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2794
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Triston Rowe (115244)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115244
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 115244
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Tyrese Noslin (158854)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158854
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Tayvon Gray (53322)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 53322
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Perry Ng (24019)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 24019
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 24019
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Petr Hodous (225947)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 225947
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Pipa (21080)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21080
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 21080
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Przemyslaw Misiak (285770)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 285770
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Semm Renders (178562)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178562
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Age' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 178562
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Severin Ottiger (94945)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 94945
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 94945
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Shinnosuke Fukuda (158810)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158810
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 158810
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Shurandy Sambo (4386)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4386
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 4386
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Tyrique Mercera (182771)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 182771
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Warren Kamanzi (66876)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66876
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by External Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 66876
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Yu Hashimoto (248250)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 248250
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rubén Sánchez (81276)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81276
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 81276
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Quincy Butler (42334)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 42334
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rafael Pinto Pedrosa (153575)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 153575
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Samuel Kopasek (107495)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107495
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rei Umeki (213896)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 213896
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rio Cardines (118606)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118606
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 118606
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Robert-Jan Vanwesemael (186238)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 186238
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Ryan Battrum (108770)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Live Scouting' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 108770
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sabil Hansen (160213)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 160213
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Sam Byram (6805)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 6805
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Rasmus Carstensen (51853)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 51853
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Koffi Kouao (103319)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 103319
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 103319
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Justin Che (78956)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78956
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 78956
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Kaius Simojoki (120630)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 120630
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kalani Kossa-Rienzi (205755)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 205755
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kasper Jørgensen (31268)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 31268
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kazuma Okamoto (180883)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 180883
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Keelan Adams (238455)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 238455
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 238455
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );

-- Lushendry Martes (199498)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 199498
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Kimito Nono (202304)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 202304
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lasse Qvigstad (107504)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 107504
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lasse Sørensen (2194)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2194
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 3
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 3' as NEW_STAGE,
    'Flagged by Internal Recommendation' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 2194
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 3'
  );

-- Lazaros Rota (54663)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 54663
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Lewin Blum (46419)
-- Initial entry at Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46419
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 2' as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 46419
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  );

-- Lilian Raolisoa (153647)
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Data' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 153647
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Cody Drameh (79698)
-- Initial entry at Stage 1
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    NULL as OLD_STAGE,
    'Stage 1' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Initial entry' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79698
  AND pl.LIST_NAME = 'RB/RWB'
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
  );

-- Update to Stage 2
INSERT INTO PLAYER_STAGE_HISTORY
    (LIST_ITEM_ID, LIST_ID, PLAYER_ID, OLD_STAGE, NEW_STAGE, REASON, DESCRIPTION, CHANGED_BY, CHANGED_AT)
SELECT
    pli.ID as LIST_ITEM_ID,
    pli.LIST_ID,
    pli.PLAYER_ID,
    'Stage 1' as OLD_STAGE,
    'Stage 2' as NEW_STAGE,
    'Flagged by Potential Availability' as REASON,
    'Stage progression' as DESCRIPTION,
    pli.ADDED_BY as CHANGED_BY,
    pli.CREATED_AT + INTERVAL '1 second' as CHANGED_AT
FROM PLAYER_LIST_ITEMS pli
JOIN PLAYER_LISTS pl ON pli.LIST_ID = pl.ID
WHERE pli.PLAYER_ID = 79698
  AND pl.LIST_NAME = 'RB/RWB'
  AND EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 1'
  )
  AND NOT EXISTS (
    SELECT 1 FROM PLAYER_STAGE_HISTORY psh
    WHERE psh.LIST_ITEM_ID = pli.ID
    AND psh.NEW_STAGE = 'Stage 2'
  );


